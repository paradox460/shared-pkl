import "https://cdn.jsdelivr.net/gh/StefMa/pkl-gha@77880b64db1f3bf24b31a359311a6f7ef64bffaa/Workflow.pkl"
import "https://cdn.jsdelivr.net/gh/StefMa/pkl-gha@77880b64db1f3bf24b31a359311a6f7ef64bffaa/Action.pkl"

elixir = new Listing<Workflow.Step> {
  (Action.cache) {
    name = "Elixir Deps cache"
    id = "elixir-deps-cache"
    path = """
      deps
      _build
      .mix/archives/
      """
    key = "elixir-build-${{hashFiles('.mise.lock')}}-${{hashFiles('mix.lock')}}"
    restoreKeys = "elixir-build-${{hashFiles('.mise.lock')}}-"
  }
  new {
    name = "Install Elixir Dependencies"
    run = """
      mix local.hex --force --if-missing
      mix deps.get
      """
  }

}
